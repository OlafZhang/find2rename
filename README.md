# find2rename
find&amp;rename images file name to previous/查找并将照片重命名为原来的名字

# 语言支持/Language Support
| Language | Supported?  |
| -------- | ----------- |
| 中文     | √ |
| English  | × |
| 日本語   | × |

# 原理？

这个程序会使用SSIM（结构相似性）算法，对源文件夹内的图片文件和待重命名文件夹内的图片文件进行特征比较，以便找回待重命名文件夹中图片的文件名

两个文件夹图片完全相同或相似时才会被匹配

例如：你通过社交媒体或工具发送你的照片给模特进行修图或其他操作，完成后模特通过社交媒体或工具发回给你，此时文件名很大概率已经发生改变（例如QQ/微信保存图片时会有它们自己的命名格式）

为方便管理和溯源，可以使用这个程序来将这些照片重命名为原来的名字


# 使用
**Release版本将在之后发布，可到issue催更**

使用源码的同学请确保自己有一定的独立思考能力和解决相关问题的能力，建议`Python版本>3.10`

### 下载
下载主程序`find2rename.py`、环境配置文件`requirements.txt`和配置文件`Config_find2rename.py`

配置文件**不会**在第一次运行主程序且工作路径下无配置文件时自动生成

### 安装第三方库

打开命令提示符/终端，进入主程序所在目录

假设你下载到了`C:\Users\olaf\Download`，在命令行分别执行：

    cd C:\Users\olaf\Download
    pip install -r requirements.txt

先不要关闭命令行，看下一步

### 修改配置文件

配置文件中各个变量名称和用途如下，也可参考配置文件内注释，注意，不要删除/修改配置文件中的引号/中括号/大括号/带`r`的引号

| 变量名 | 用途 | 是否必须 | 数据类型 | 备注 |
| -------- | ----------- | -------- | ----------- | -------- |
| needRenameFoldersName | 包含需要重命名文件的文件夹路径 | 是 | 字符串 | |
| sourceFileFoldersName | 含有源文件的文件夹路径 | 是 | 字符串 | |
| threshold | 相似度阈值 | 是 | 单精浮点 | 建议`0.9`（如果图片只是被修容等小变化），若存在调色或较大变化，建议`0.55`，图片差异过大/调整了构图可能会造成程序运行结果与预期不符 |
| ifPossibleThenRename | 若存在可能结果但未达到相似度阈值，视为找到了相似/一致照片 | 是 | 布尔值 | 实验性功能，建议为`False` |
| prefix | 重命名文件前缀 | 是 | 字符串 | 如果不需要，改为`""` |
| postfix | 重命名文件后缀 | 是 | 字符串 | 如果不需要，改为`""` |
| zoomLevel | 预处理图片尺寸缩放等级 | 是 | 单精浮点 | 默认为`1.0`，只能`<=1.0`，过小的缩放等级会影响准确度，对于6000px*4000px的图片，建议设置为`0.3`以兼顾速度和准确度 |
| fileSupport | 文件扩展名支持 | 是 | 列表 | 只比较列表内提及的扩展名的图片文件，建议`["jpg","jpeg","png"]`，注意列表内必须填小写，但实际文件的扩展名可大写也可小写 |
| threadWorker | 线程数 | 是 | 整数 | 建议`10` |

### 运行

如果使用MySQL/MariaDB，确保已经创建了数据库，数据表会在运行程序时自动创建

在命令行执行(注意：Linux/macOS用户可能需要将`python`改为`python3`)：

    python find2rename.py 

可能可以通过双击`fileHash.py`来运行程序

